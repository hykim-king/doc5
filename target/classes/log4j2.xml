<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="warn">
<!-- Log4j2 자체의 내부 동작 로그 레벨을 INFO로 설정하는 옵션이며,
애플리케이션 로그 레벨과는 무관하다. -->
  <Appenders>
    <!-- 콘솔 로그 -->
    <Console name="Console" target="SYSTEM_OUT">
      <PatternLayout
        pattern="[%d{HH:mm:ss}] [%-5level] %logger{36} - %msg%n" />
    </Console>

    <!-- 롤링 파일 로그 -->
    <RollingFile name="RollingFile"
      fileName="logs/app-log.log"
      filePattern="logs/archive/app-log-%d{yyyy-MM-dd}-%i.log.gz">

      <PatternLayout
        pattern="[%d{yyyy-MM-dd HH:mm:ss}] [%-5level] %logger{36} - %msg%n" />

      <Policies>
        <!-- 시간 기준: 매일 롤링 -->
        <TimeBasedTriggeringPolicy interval="1"
          modulate="true" />
        <!-- 용량 기준: 10MB 이상이면 롤링 -->
        <SizeBasedTriggeringPolicy size="10MB" />
      </Policies>

      <!-- 백업 보관 최대 개수 -->
      <DefaultRolloverStrategy max="30" />
    </RollingFile>
  </Appenders>

  <Loggers>
    <!-- log level -->
    <Logger name="com.project" level="debug" additivity="false">
      <AppenderRef ref="Console" />
      <AppenderRef ref="RollingFile" />
    </Logger>
    
    <!-- MyBatis -->
    <Logger name="org.mybatis" level="debug" additivity="false">
      <AppenderRef ref="Console" />
      <AppenderRef ref="RollingFile" />
    </Logger>    
    <Logger name="org.mybatis.spring" level="debug" additivity="false">
      <AppenderRef ref="Console" />
      <AppenderRef ref="RollingFile" />
    </Logger> 

    <Root level="info">
      <AppenderRef ref="Console" />
      <AppenderRef ref="RollingFile" />
    </Root>
  </Loggers>
</Configuration>
